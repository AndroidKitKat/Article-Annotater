<!doctype html>
<html>
  <head>
  <!-- Angular Material style sheet -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic">
  <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/angular_material/1.0.5/angular-material.min.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/animate.css">
  <link rel="stylesheet" href="comment/comment.css">
</head>
<body ng-app="ArticleAnnotater" ng-controller="AppCtrl" ng-cloak>
	<div ng-include ng-controller="CommentsCtrl" src="'comment/comment.html'"></div>

	<md-toolbar class="md-whiteframe-8dp">
	  <div class="md-toolbar-tools">
	  	<span flex></span>
	  </div>
	</md-toolbar>

	<div ng-controller="ExtractorCtrl" layout="column">
		<md-content layout="row" layout-align="center center"
			class="md-whiteframe-2dp" layout-padding>
			<md-input-container class="md-block" flex>
			   <label>Article URL</label>
			   <input ng-model="url" md-select-on-focus>
			</md-input-container>
			<md-button ng-click="extract()" ng-disabled="isUrlEmpty()"
				layout-align=" center" class="md-fab">
	            <md-icon md-svg-src="img/icons/ic_search_black_24px.svg"></md-icon>
	        </md-button>
  		</md-content>

		<div class="page-container">
			<article text="{{ article }}" add="addCustomer()"></article>
		</div>
	</div>
  
  <!-- Angular Material requires Angular.js Libraries -->
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-animate.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-aria.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-messages.min.js"></script>

  <!-- Angular Material Library -->
  <script src="http://ajax.googleapis.com/ajax/libs/angular_material/1.0.5/angular-material.min.js"></script>
  <script src="js/angular-component/angular-pageslide-directive.min.js"></script>
  <script src="js/angular-component/article/angular-article-directive.js"></script>
 
  <!-- Your application bootstrap  -->
  <script type="text/javascript">
    angular
    	.module('ArticleAnnotater', ['ngMaterial', 'pageslide-directive', 'article-directive'])
    	.controller('AppCtrl', function ($scope) {
			$scope.checked = false; // This will be binded using the ps-open attribute
            $scope.toggle = function(){
                $scope.checked = !$scope.checked
            }

			$scope.onKeyUp = function ($event) {
				var key = window.event ? $event.keyCode : $event.which;
				if (key == '67') {
					$scope.toggle();
				}
		    };
		    
		    $scope.getSelectionText = function() {
				if(window.getSelection) {
				    return window.getSelection().toString();
				}
				
				if(document.selection && document.selection.type != "Control") {
				    return document.selection.createRange().text;
				}
				return "";
		    };
		})
    	.controller('ExtractorCtrl', function($scope, $http, $sce) {
			$scope.url = "";
			$scope.article = "";

			$scope.extract = function() {
				$http
					.get('/article?url=' + encodeURIComponent($scope.url))
			        .success(function(data) {
			            $scope.article = $sce.trustAsHtml(data.text);
			        });
			};
			$scope.isUrlEmpty = function() {
				return $scope.url == null || $scope.url.length == 0;
			};
		})
		.controller('CommentsCtrl', function($scope) {
		});
  </script>
  <script src="comment/comment.js"></script>
  
</body>
</html>